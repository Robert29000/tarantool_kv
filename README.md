# KV-хранилище

## Требования

Предварительно необходимо установить следующие пакеты: **lua**, **tarantool**, **cmake**. Для работы http-сервера нужно также  установить соответствующую библиотеку через сам **tarantool**. Это можно сделать командой, которую следует запустить в корне приложения:

```sh
$ tarantoolctl rocks install http
```

## API

Реализованы все методы согласно требованиям: ```GET```, ```POST```, ```PUT```, ```DELETE```. Все изменения и ошибки логируются. Логи хранятся в файле **logs/server_log.log**. Описание операций:

    1) **GET**: Возвращает JSON по ключу, указанному в пути (/kv/key). Если такого ключа нет, то возвращается ошибка **404**

    2) **POST**: Добавляет значение по ключу. Если ключ уже существует, то возвращается ошибка **409**. Если JSON, передаваемый в body некорректный, то возвращается ошибка **400**. В случае успеха возращается JSON с положительным статусом

    3) **PUT**: Обновляет значение по ключу, указанному в пути (/kv/key). Если ключа не существует, то возвращается ошибка **404**. Если JSON, передаваемый в body некорректный, то возвращается ошибка **400**. В случае успеха возращается JSON с положительным статусом
    
    4) **DELETE**: Удаляет значение по ключу, указанному в пути (/kv/key). Если ключа не существует, то возвращается ошибка **404**. В случае успеха возращается JSON с положительным статусом

## Запуск сервиса

Для запуска сервиса нужно скопировать данный git-репозиторий. Необходимо также удостовериться, что не запущен другой процесс **tarantool**. Создадим отдельную службу в ОС. Это можно сделать командой:
```sh
$ nano /etc/systemd/system/api.service
```
В открывшемся окне редактора, пропишем:
```sh
[Unit]
Description=<project description>
After=network.target
StartLimitIntervalSec=0

[Service]
Type=simple
Restart=always
RestartSec=1
User=<user name>
WorkingDirectory=<path/to/project>
ExecStart=/usr/bin/env tarantool <path/to/project/api.lua>

[Install]
WantedBy=multi-user.target
```

После запускаем сервис и делаем его доступным, чтобы он постоянно работал:
```sh
$ sudo systemctl start api
$ sudo systemctl enable api
```

Запущенный сервис доступен по адресу - http://167.99.135.65:8080
